<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <title>osite</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">

    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
</head>

<body>
    <!--Title-->
    <h1 style="margin: 0px;">the webtiete</h1>
    <nav style="margin-bottom: 20px;">
        <a href="index.html">Main Page</a> | <a href="calcs.html">Calculators</a> | <a href="games.html">Games</a>
    </nav>
    <!--<p id="currentTime"></p>
    <h3>daily derivitive (day 1):</h3>
    <h2 id="equation"></h2>
    -->

    <canvas id="piCanvas" width="600" height="300" style="border:3px solid white; background-color: #141414;"></canvas>


    <button id="start">start simulation</button>
    <input id="massSlider" type="range" min="0" max="6" step="2" value="0"> <!--define min and max of the mass slider-->


    <script>

        const massSlider = document.getElementById("massSlider")

        const canvas = document.getElementById("piCanvas")
        const ctx = canvas.getContext("2d")

        var massHeavyBlock = Math.pow(10, massSlider.value)
        var massLightBlock = 1
        var velocityLightBlock = 0
        var sizeHeavyBlock = 50 + (Number(massSlider.value) - 0) / (12 - 0) * (150 - 50) 
        var sizeLightBlock = 50
        var velocityHeavyBlock = 1
        var simulationOn = false
        var posLightBlock = 150
        var posHeavyBlock = 400
        var justTouchedWall = false
        var hitCount = 0

        function draw() {
            if(simulationOn){
                posHeavyBlock-=velocityHeavyBlock
                posLightBlock-=velocityLightBlock
                if(posLightBlock+sizeLightBlock>=posHeavyBlock){
                    vi2=velocityHeavyBlock
                    vi1=velocityLightBlock
                    velocityLightBlock = ((massLightBlock - massHeavyBlock) / (massLightBlock + massHeavyBlock)) * vi1 + (2 * massHeavyBlock / (massLightBlock + massHeavyBlock)) * vi2
                    velocityHeavyBlock = (2 * massLightBlock / (massLightBlock + massHeavyBlock)) * vi1 + ((massHeavyBlock - massLightBlock) / (massLightBlock + massHeavyBlock)) * vi2
                    justTouchedWall = false
                    hitCount++
                }
                if(posLightBlock<50 && !justTouchedWall){
                    velocityLightBlock = -velocityLightBlock
                    justTouchedWall = true
                    hitCount++
                }
                if(velocityHeavyBlock<=velocityLightBlock && velocityHeavyBlock <= 0 && velocityLightBlock <= 0){
                    console.log("final count: " + hitCount)
                }
            }
            ctx.clearRect(0, 0, canvas.width, canvas.height)

            ctx.fillStyle = "blue" //the heavy one
            ctx.fillRect(posHeavyBlock, 250 - (sizeHeavyBlock), sizeHeavyBlock, sizeHeavyBlock)
            ctx.fillStyle = "orange" //the bumper that makes pi
            ctx.fillRect(posLightBlock, 250 - (sizeLightBlock), sizeLightBlock, sizeLightBlock)

            ctx.strokeStyle = "white"
            ctx.lineWidth = 3

            ctx.beginPath() //draw white horizontal line
            ctx.moveTo(50, 250)
            ctx.lineTo(600, 250)
            ctx.stroke()

            ctx.beginPath() //draw white vertical line
            ctx.moveTo(50, 0)
            ctx.lineTo(50, 250)
            ctx.stroke()

            // show collision count on screen
            ctx.fillStyle = "white"
            ctx.font = "20px Arial"
            ctx.fillText("Collisions: " + hitCount, 60, 30)

            requestAnimationFrame(draw)
        }

        draw()
        /*
        v1f = ((massLightBlock - massHeavyBlock) / (massLightBlock + massHeavyBlock)) * v1i + (2 * massHeavyBlock / (massLightBlock + massHeavyBlock)) * v2i
    v2f = (2 * massLightBlock / (massLightBlock + massHeavyBlock)) * v1i + ((massHeavyBlock - massLightBlock) / (massLightBlock + massHeavyBlock)) * v2i
        */

        const startButton = document.getElementById("start")

        startButton.addEventListener("click", () => {
            simulationOn = true
            console.log(Math.floor(Math.PI * Math.pow(10, (Math.log10(massHeavyBlock) / 2))))
        })

        massSlider.addEventListener("input", () => {
            massHeavyBlock = Math.pow(10, Number(massSlider.value));
            sizeHeavyBlock = 50 + (Number(massSlider.value) - 0) / (12 - 0) * (150 - 50)  //block scales linearly
        })
        

        /*
        function getRandomInt(min, max) {
            min = Math.ceil(min);
            max = Math.floor(max);
            return Math.floor(Math.random() * (max - min)) + min;
        }
            */

        /*
        

        function randomConstant() {
            while (true) {
                if (Math.random() > 0.5) {
                    var n = getRandomInt(-20, 25);
                    if (n != 0 && n != 1) {
                        return n;
                    }
                } else {
                    return special[getRandomInt(0, special.length)]
                }
            }
        }

        var eq = "";

        //p can be funcs or constants, r is only for translating operators
        //sqrt[n] chooses a random number for n
        const funcs = ["root", "\\sin({phrase})", "\\cos({phrase})", "\\tan({phrase})", "\\frac{phrase}{phrase}", "\\ln({phrase})"]
        const operators = ["+phrase", "-phrase", "*phrase", "^{phrase}", "e^{phrase}"]
        const special = ["\\pi", "e"];

        //a "phrase" is anything in the tables.
        function replace(phrase, array) {
            var newPhrase = array[getRandomInt(0, array.length)]

            if (array == "constant") {
                const pIndex = phrase.indexOf("phrase");

                return phrase.slice(0, pIndex) + randomConstant() + phrase.slice(pIndex + 6);
            } else if (array == funcs) {
                const pIndex = phrase.indexOf("phrase");

                if (newPhrase == "root") {
                    var root = getRandomInt(1, 8);
                    newPhrase = "\\sqrt[" + getRandomInt(1, 8) + "]{phrase}";
                }

                return phrase.slice(0, pIndex) + newPhrase + replace(newPhrase, operators) + phrase.slice(pIndex + 6);
            } else if (array == operators) {
                return phrase + newPhrase;
            }
        }

        function parse(phrase, depth) {
            if (!phrase.includes("phrase")) return phrase;

            if (depth < 1) {
                phrase = replace(phrase, funcs);
            } else {
                phrase = replace(phrase, "constant");
            }

            console.log(phrase);
            return parse(phrase, depth + 1);
        }

        eq = funcs[getRandomInt(0, funcs.length)] + operators[getRandomInt(0, operators.length)];

        */

        /*
        //imma call these phrases ok
        const functions = [
            "\\sqrt{abc}",
            "\\sin(abc)",
            "\\cos(abc)"
        ];
        const operators = [
            "abc+xyz",
            "abc-xyz",
            "abc*xyz",
            "\\frac{abc}{xyz}",
            "{abc}^{xyz}"
        ];
        const constants = ["\\pi", "e"];

        function getRandom(dict) {
            const values = Object.values(dict);
            return "{" + values[getRandomInt(0, values.length)] + "}";
        }
            */

        //first layer of arrays goes to operators only.
        //first layer: [operator[abc]] (functions or constants in abc)
        //next array in first layer goes into the xyz of the last.
        
        //[
        //    [operator[abc][xyz], [abc's function or constant]],
        //    [operator[abc][xyz], [abc's function or constant]],
        //    [xyz of last function (pick a functon or constant)]
        //]
        
        /*
        var equation = [
            ["abc+xyz", "2"],
            ["abc+xyz", ["\\sqrt{abc}", ["\\sin(abc)", "x"]]],
            ["\\frac{abc}{xyz}", ["\\cos(abc)", "x"]],
            ["{abc}^{xyz}", ["\\cos(abc)", "x"]],
            ["\\frac{abc}{xyz}", "x"],
            ["\\sin(abc)", "x"]
        ];
        */


        //Array.isArray(variable)

        //var equationString = "";
        
        /*
        function go(array) {
            array.forEach(phraseArray => {
                var result = "";
                if (Array.isArray(phraseArray[1])) {
                    go(phraseArray[1]);
                } else {
                    var newString = phraseArray[0];
                    console.log("------------")
                    console.log(typeof phraseArray)
                    console.log(phraseArray)
                    console.log(phraseArray[0])
                    console.log(phraseArray[1])
                    //console.log(newString);
                    newString = newString.replace("abc", phraseArray[1]);
                    console.log(newString)
                    equationString += newString;
                }
            });
        }
        */


        //const equationString = go(equation);
        //console.log(equationString);

// â†’ 2+\sqrt{\sin(x)}+\frac{\cos(x)}{{\cos(x)}^{\frac{x}{\sin(x)}}}



        //document.getElementById("equation").innerHTML = "\\(\\frac{d}{dx}" + equationString + "\\)";
        //MathJax.typesetPromise();
    </script>
</body>

</html>